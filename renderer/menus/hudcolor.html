<script>
  function hexToRgb(hex) {
    var result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
    return result ? {
      r: parseInt(result[1], 16),
      g: parseInt(result[2], 16),
      b: parseInt(result[3], 16)
    } : null;
  };
  var color = hexToRgb($("#hudColor").val());
  $(".colorPicker").css("background", $("#hudColor").val());
  $("#command").val(`bxt_hud_color "${color.r} ${color.g} ${color.b}"`);
  $("#hudColor").on('input', () => {
    var color = hexToRgb($("#hudColor").val());
    $(".colorPicker").css("background", $("#hudColor").val());
    $("#command").val(`bxt_hud_color "${color.r} ${color.g} ${color.b}"`);
  });
  function writeHUDToGame(game){
    let old;
    if(fs.existsSync("./Half-Life/" + game + "/autoexec.cfg")){
      old = fs.readFileSync("./Half-Life/" + game + "/autoexec.cfg").toString();
      let old_color = old.match(/bxt_hud_color [^\n]*/);
      if(old_color){
        for(let i = 0; i < old_color.length; i++){
          old = old.replace(old_color[i], '');
        };
      };
    }else{
      old = "";
    };
    return old;
  };
  $("#save").click(() => {
    let valve = writeHUDToGame("valve");
    let gearbox = writeHUDToGame("gearbox");
    let bshift = writeHUDToGame("bshift");
    
    valve += "\n" + $("#command").val();
    gearbox += "\n" + $("#command").val();
    bshift += "\n" + $("#command").val();
    fs.writeFileSync("./Half-Life/valve/autoexec.cfg", valve);
    fs.writeFileSync("./Half-Life/gearbox/autoexec.cfg", gearbox);
    fs.writeFileSync("./Half-Life/bshift/autoexec.cfg", bshift);
  });
</script>
<div class="list">
  <input type="color" id="hudColor" value="#4f6cff">
  <div class="colorPicker" onclick="$('#hudColor').click()"></div>
  <input type="text" id="command" readonly>
  <div class="buttonsList">
    <div class="button" onclick="$('#hudColor').click()">SELECT COLOR</div>
    <div class="button" id="save">SAVE</div>
    <div class="button" onclick="panel.loadMenu('CUSTOMIZATION')">BACK</div>
  </div>
</div>
<div class="bottom">UI color changer (only with Bunnymod XT) (not working in Blue Shift).</div>
